<!DOCTYPE html>
<html>
<head>
    <title>Plugin Debug Helper</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #e8f5e8; border: 1px solid #4caf50; }
        .error { background: #ffeaea; border: 1px solid #f44336; }
        .warning { background: #fff3cd; border: 1px solid #ffc107; }
        .test-btn { background: #007acc; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .test-btn:hover { background: #005a9e; }
        pre { background: #f8f8f8; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Figma Plugin Debug Helper</h1>
        
        <div class="status success">
            <strong>‚úÖ Ready for Testing!</strong> All systems operational.
        </div>

        <h2>üß™ Quick Tests</h2>
        <button class="test-btn" onclick="testMCPServer()">Test MCP Server</button>
        <button class="test-btn" onclick="testUI()">Test UI Load</button>
        <button class="test-btn" onclick="showConfig()">Show Config</button>
        
        <div id="results"></div>

        <h2>üìã Import Instructions</h2>
        <ol>
            <li><strong>Open Figma Desktop App</strong></li>
            <li>Go to <strong>Plugins ‚Üí Development ‚Üí Import plugin from manifest...</strong></li>
            <li>Navigate to and select: <code>/Users/david/Documents/Figa-Jira-Automations-Tool/figma-ticket-generator/manifest.json</code></li>
            <li>Click <strong>"Save"</strong></li>
            <li>Test with: <strong>Plugins ‚Üí Development ‚Üí "AI Ticket Generator (MCP)"</strong></li>
        </ol>

        <h2>üéØ Testing Checklist</h2>
        <div id="checklist">
            <input type="checkbox" id="import"> <label for="import">Plugin imported successfully</label><br>
            <input type="checkbox" id="load"> <label for="load">Plugin UI loads without errors</label><br>
            <input type="checkbox" id="features"> <label for="features">All features visible (Parse Tech, Popular Combinations)</label><br>
            <input type="checkbox" id="selection"> <label for="selection">Selection detection works</label><br>
            <input type="checkbox" id="context"> <label for="context">Context banner appears with selection</label><br>
            <input type="checkbox" id="tickets"> <label for="tickets">Context-aware tickets generated</label><br>
        </div>

        <h2>üö® Common Issues & Solutions</h2>
        <details>
            <summary><strong>Plugin won't load</strong></summary>
            <p>‚Ä¢ Check manifest.json path is correct<br>
            ‚Ä¢ Ensure Figma Desktop app (not web)<br>
            ‚Ä¢ Try refreshing Figma</p>
        </details>
        
        <details>
            <summary><strong>No context banner appearing</strong></summary>
            <p>‚Ä¢ Ensure frames/components are selected in Figma<br>
            ‚Ä¢ Check browser console for errors<br>
            ‚Ä¢ Verify MCP server is running</p>
        </details>
        
        <details>
            <summary><strong>Generic tickets despite selection</strong></summary>
            <p>‚Ä¢ Check frame names are descriptive<br>
            ‚Ä¢ Verify postMessage communication<br>
            ‚Ä¢ Test with simpler selections first</p>
        </details>
    </div>

    <script>
        async function testMCPServer() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="status warning">Testing MCP Server...</div>';
            
            try {
                const response = await fetch('http://localhost:3000', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({method: 'test'})
                });
                
                if (response.ok) {
                    results.innerHTML = '<div class="status success">‚úÖ MCP Server responding on localhost:3000</div>';
                } else {
                    results.innerHTML = '<div class="status error">‚ùå MCP Server error: ' + response.status + '</div>';
                }
            } catch (error) {
                results.innerHTML = '<div class="status error">‚ùå MCP Server not reachable: ' + error.message + '</div>';
            }
        }

        function testUI() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="status success">‚úÖ UI Helper loaded successfully. Plugin UI should work in Figma.</div>';
        }

        function showConfig() {
            const results = document.getElementById('results');
            results.innerHTML = `
                <div class="status success">
                    <strong>Plugin Configuration:</strong>
                    <pre>Name: AI Ticket Generator (MCP)
ID: figma-ai-ticket-generator-2024
Main: code.js
UI: dist/ui/index.html
Network: localhost:3000 allowed
Permissions: currentuser</pre>
                </div>
            `;
        }
    </script>
</body>
</html>