<!DOCTYPE html>
<html>
<head>
    <title>Parse Tech Stack Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        button { padding: 10px 15px; margin: 5px; }
        input, textarea { width: 300px; padding: 5px; margin: 5px; }
    </style>
</head>
<body>
    <h1>üß™ Parse Tech Stack Function Test</h1>
    
    <div class="test-section">
        <h3>Test Parse Tech Stack Function</h3>
        <textarea id="techStackInput" placeholder="Enter tech stack description..." rows="3">React 18 with TypeScript, Material-UI v5, React Query for state management, Jest for testing, Webpack bundling</textarea><br>
        <button onclick="testParseTechStack()">üîç Parse Tech Stack</button>
        <div id="parseResult" style="margin-top: 10px;"></div>
    </div>

    <div class="test-section">
        <h3>Enhanced Frame Data Test</h3>
        <button onclick="testEnhancedFrameData()">üß™ Test Enhanced Data Processing</button>
        <div id="enhancedResult" style="margin-top: 10px;"></div>
    </div>

    <script>
        // Copy the parseTechStack function from the main UI
        function parseTechStack(description) {
            const techStack = {
                frameworks: [],
                languages: [],
                tools: [],
                databases: [],
                cloud: [],
                testing: [],
                confidence: 0,
                suggestions: []
            };
            
            if (!description || typeof description !== 'string') {
                return { ...techStack, confidence: 0, suggestions: ['No description provided'] };
            }

            const text = description.toLowerCase();
            
            // Frameworks
            const frameworks = {
                'react': ['react 18', 'react.js', 'reactjs', 'react'],
                'vue': ['vue.js', 'vue 3', 'vue'],
                'angular': ['angular', 'angularjs'],
                'svelte': ['svelte', 'sveltekit'],
                'next.js': ['next.js', 'nextjs', 'next'],
                'nuxt': ['nuxt.js', 'nuxt'],
                'express': ['express.js', 'express'],
                'fastify': ['fastify'],
                'nest.js': ['nest.js', 'nestjs']
            };
            
            // Languages
            const languages = {
                'typescript': ['typescript', 'ts'],
                'javascript': ['javascript', 'js'],
                'python': ['python', 'python3'],
                'java': ['java'],
                'csharp': ['c#', 'csharp', '.net'],
                'go': ['golang', 'go'],
                'rust': ['rust'],
                'php': ['php']
            };
            
            // Tools & Libraries
            const tools = {
                'material-ui': ['material-ui', 'mui', '@mui'],
                'tailwind': ['tailwind', 'tailwindcss'],
                'webpack': ['webpack'],
                'vite': ['vite'],
                'eslint': ['eslint'],
                'prettier': ['prettier'],
                'babel': ['babel'],
                'sass': ['sass', 'scss']
            };
            
            // Testing
            const testing = {
                'jest': ['jest'],
                'vitest': ['vitest'],
                'cypress': ['cypress'],
                'playwright': ['playwright'],
                'testing-library': ['testing-library', '@testing-library']
            };
            
            // Cloud/Deployment
            const cloud = {
                'aws': ['aws', 'amazon web services'],
                'azure': ['azure', 'microsoft azure'],
                'gcp': ['gcp', 'google cloud'],
                'vercel': ['vercel'],
                'netlify': ['netlify'],
                'docker': ['docker']
            };
            
            // Databases
            const databases = {
                'postgresql': ['postgres', 'postgresql'],
                'mongodb': ['mongodb', 'mongo'],
                'mysql': ['mysql'],
                'redis': ['redis'],
                'sqlite': ['sqlite']
            };

            let matchCount = 0;
            const allCategories = { frameworks, languages, tools, testing, cloud, databases };
            
            for (const [category, items] of Object.entries(allCategories)) {
                for (const [tech, patterns] of Object.entries(items)) {
                    if (patterns.some(pattern => text.includes(pattern))) {
                        techStack[category].push(tech);
                        matchCount++;
                    }
                }
            }
            
            // Calculate confidence
            const wordCount = description.split(/\s+/).length;
            techStack.confidence = Math.min(95, Math.max(10, (matchCount * 15) + (wordCount > 5 ? 10 : 0)));
            
            // Generate suggestions
            if (techStack.confidence < 50) {
                techStack.suggestions.push('Consider providing more specific technology details');
            }
            if (techStack.frameworks.length === 0) {
                techStack.suggestions.push('No framework detected - specify your frontend/backend framework');
            }
            if (techStack.languages.length === 0) {
                techStack.suggestions.push('Programming language not clearly specified');
            }
            
            return techStack;
        }

        function testParseTechStack() {
            const input = document.getElementById('techStackInput').value;
            const result = parseTechStack(input);
            
            document.getElementById('parseResult').innerHTML = `
                <div class="success">
                    <h4>‚úÖ Parse Results:</h4>
                    <p><strong>Confidence:</strong> ${result.confidence}%</p>
                    <p><strong>Frameworks:</strong> ${result.frameworks.join(', ') || 'None detected'}</p>
                    <p><strong>Languages:</strong> ${result.languages.join(', ') || 'None detected'}</p>
                    <p><strong>Tools:</strong> ${result.tools.join(', ') || 'None detected'}</p>
                    <p><strong>Testing:</strong> ${result.testing.join(', ') || 'None detected'}</p>
                    <p><strong>Suggestions:</strong> ${result.suggestions.join('; ') || 'None'}</p>
                </div>
            `;
        }

        function testEnhancedFrameData() {
            const sampleData = {
                "enhancedFrameData": [
                    {
                        "id": "I10582:37809;10582:36353",
                        "name": "Right",
                        "type": "GROUP",
                        "x": 960,
                        "y": 0,
                        "width": 960,
                        "height": 600.0009765625,
                        "visible": true,
                        "locked": false,
                        "dimensions": {
                            "width": 960,
                            "height": 600.0009765625,
                            "x": 960,
                            "y": 0
                        },
                        "hierarchy": {
                            "layers": [
                                {
                                    "id": "I10582:37809;10582:36353",
                                    "name": "Right",
                                    "type": "GROUP",
                                    "depth": 1
                                }
                            ],
                            "totalDepth": 5,
                            "componentCount": 3
                        },
                        "metadata": {
                            "colors": [],
                            "semanticRole": "group",
                            "extractedAt": "2025-10-21T17:47:42.827Z",
                            "figmaType": "GROUP",
                            "hasText": false,
                            "isComponent": false,
                            "childCount": 4
                        }
                    }
                ],
                "fileContext": {
                    "fileKey": "dev-file",
                    "fileName": "Solidigm Dotcom 3.0 - Dayani",
                    "pageId": "10513:20218",
                    "pageName": "‚úÖ Suppliers"
                },
                "metadata": {
                    "selectionCount": 1,
                    "pageInfo": {
                        "id": "10513:20218",
                        "name": "‚úÖ Suppliers"
                    }
                }
            };

            document.getElementById('enhancedResult').innerHTML = `
                <div class="success">
                    <h4>‚úÖ Enhanced Frame Data Test:</h4>
                    <p><strong>Components Found:</strong> ${sampleData.enhancedFrameData.length}</p>
                    <p><strong>Component Name:</strong> ${sampleData.enhancedFrameData[0].name}</p>
                    <p><strong>Semantic Role:</strong> ${sampleData.enhancedFrameData[0].metadata.semanticRole}</p>
                    <p><strong>Hierarchy Depth:</strong> ${sampleData.enhancedFrameData[0].hierarchy.totalDepth}</p>
                    <p><strong>Component Count:</strong> ${sampleData.enhancedFrameData[0].hierarchy.componentCount}</p>
                    <p><strong>Has Required Fields:</strong> 
                       dimensions: ‚úÖ, 
                       hierarchy: ‚úÖ, 
                       metadata: ‚úÖ
                    </p>
                </div>
            `;
        }

        // Auto-run test on load
        window.onload = function() {
            testParseTechStack();
        };
    </script>
</body>
</html>